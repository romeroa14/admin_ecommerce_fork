name: Deploy to Hostinger (SSH)

on:
  push:
    branches: [ "main" ]

concurrency:
  group: production
  cancel-in-progress: true

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Deploy over SSH
        uses: appleboy/ssh-action@v1.2.0
        with:
          host: ${{ secrets.HOSTINGER_SSH_HOST }}
          username: ${{ secrets.HOSTINGER_SSH_USER }}
          key: ${{ secrets.HOSTINGER_SSH_KEY }}
          port: ${{ secrets.HOSTINGER_SSH_PORT }}
          script: |
            echo "=== Current directory ==="
            pwd
            echo ""
            echo "=== Home directory content ==="
            ls -la ~
            echo ""
            echo "=== Looking for common web directories ==="
            for dir in public_html htdocs www domains; do
              if [ -d ~/$dir ]; then
                echo "✓ Found: ~/$dir"
                ls -la ~/$dir
              else
                echo "✗ Not found: ~/$dir"
              fi
            done
            echo ""
            echo "=== Checking if git is available ==="
            which git && git --version || echo "Git not found"
            echo ""
            echo "=== Checking if composer is available ==="
            which composer && composer --version || echo "Composer not found"
